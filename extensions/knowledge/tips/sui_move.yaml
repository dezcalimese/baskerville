chain: sui
tips:
  - id: "TIP-SUI-OBJ-01"
    title: "Shared object race conditions"
    category: "Object Safety"
    tip: "Shared objects can be accessed by multiple transactions concurrently. Critical operations on shared objects should use ordered access patterns or implement locking mechanisms."
    code_pattern: "share_object|public_share_object"
    tags: ["shared-object", "race-condition", "sui"]
    priority: "high"
  - id: "TIP-SUI-CAP-01"
    title: "Capability leakage"
    category: "Capability Patterns"
    tip: "Capabilities should never be stored in shared objects or transferred to untrusted addresses. Check that AdminCap/TreasuryCap are only held by authorized addresses."
    code_pattern: "Cap\\b|AdminCap|TreasuryCap"
    tags: ["capability", "access-control", "sui"]
    priority: "high"
  - id: "TIP-SUI-OTW-01"
    title: "One-time witness misuse"
    category: "Witness Patterns"
    tip: "The OTW struct must have `drop` ability and no fields. It should be consumed in the init function. Storing or copying an OTW defeats its purpose."
    code_pattern: "init\\(witness:"
    tags: ["witness", "one-time-witness", "sui"]
    priority: "high"
  - id: "TIP-SUI-GEN-01"
    title: "Type confusion via generics"
    category: "Type Safety"
    tip: "Generic type parameters can be instantiated with any type. Ensure sensitive operations properly constrain generic parameters. A Pool<FakeCoin> should not interact with Pool<RealCoin>."
    code_pattern: "<T:|phantom T>"
    tags: ["generics", "type-confusion", "sui"]
    priority: "high"
  - id: "TIP-SUI-DYN-01"
    title: "Dynamic field manipulation"
    category: "Dynamic Fields"
    tip: "Dynamic fields allow adding arbitrary data to objects. Check that only authorized users can add/remove dynamic fields. Look for missing authorization on dynamic_field::add/remove."
    code_pattern: "dynamic_field::|dynamic_object_field::"
    tags: ["dynamic-field", "manipulation", "sui"]
    priority: "high"
  - id: "TIP-SUI-OWN-01"
    title: "Object ownership transfer exploits"
    category: "Object Safety"
    tip: "Once an object is transferred, the original owner loses access. Check for situations where transfer::public_transfer is called on objects that should remain owned."
    code_pattern: "public_transfer|transfer::transfer"
    tags: ["ownership", "transfer", "sui"]
    priority: "medium"
  - id: "TIP-SUI-HOT-01"
    title: "Hot potato pattern misuse"
    category: "Design Patterns"
    tip: "Hot potato objects (no drop/store/copy) must be consumed in the same transaction. Verify they can't be abandoned or used to bypass checks."
    code_pattern: null
    tags: ["hot-potato", "flash-loan", "sui"]
    priority: "medium"
  - id: "TIP-SUI-VIS-01"
    title: "Missing public(friend) restrictions"
    category: "Module Visibility"
    tip: "Functions that should only be called by trusted modules must use public(friend) or public(package). Check that sensitive internal functions aren't public entry."
    code_pattern: "public fun|public entry fun"
    tags: ["visibility", "friend", "access-control", "sui"]
    priority: "high"
  - id: "TIP-SUI-MATH-01"
    title: "Arithmetic overflow via `as` casts"
    category: "Math"
    tip: "Move's `as` operator truncates silently. `(256u64 as u8)` gives 0 without error. Use checked casts or validate ranges before casting."
    code_pattern: "as u8|as u16|as u32|as u64"
    tags: ["overflow", "cast", "math", "sui"]
    priority: "high"
  - id: "TIP-SUI-SHARE-01"
    title: "Unchecked public_transfer on shared objects"
    category: "Object Safety"
    tip: "Using public_transfer on a shared object can convert it to an owned object, breaking other users' access. Only use transfer::public_share_object for objects that should stay shared."
    code_pattern: "public_transfer"
    tags: ["shared-object", "transfer", "sui"]
    priority: "high"
  - id: "TIP-SUI-UPG-01"
    title: "Package upgrade attacks"
    category: "Upgrade Safety"
    tip: "Sui supports package upgrades. Check the UpgradeCap ownership and upgrade policy. Ensure the upgrade cap isn't accessible to unauthorized parties."
    code_pattern: "UpgradeCap|upgrade_policy"
    tags: ["upgrade", "package", "sui"]
    priority: "medium"
  - id: "TIP-SUI-CLK-01"
    title: "Clock manipulation"
    category: "Time Safety"
    tip: "The Clock shared object provides timestamps but with validator consensus delay. Time-sensitive operations should account for potential manipulation or delay."
    code_pattern: "clock::timestamp_ms|Clock"
    tags: ["clock", "timestamp", "manipulation", "sui"]
    priority: "medium"
